@using EduPlanApp.Models
@model List<TaskViewModel>

@{
    ViewData["Title"] = "Усі Навчальні Завдання";
    Layout = "_Layout";
}

<h1 class="text-3xl font-bold mb-6">@ViewData["Title"]</h1>

<div class="mb-4 flex justify-between items-center">
    <a asp-action="TaskCreator" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150">
        + Створити Нове Завдання
    </a>
    <a asp-action="DeadlineManager" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg transition duration-150">
        Пошук завдань
    </a>
</div>

@if (TempData["Message"] != null)
{
    <div class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4 rounded-lg" role="alert">
        <p>@TempData["Message"]</p>
    </div>
}

@if (Model.Any())
{
    <div class="shadow-lg rounded-lg overflow-hidden">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-100">
                <tr>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Завдання</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Категорія</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Пріоритет</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Кінцевий термін</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Статус</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Дії</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                @foreach (var task in Model)
                {
                    <tr class="@(task.IsCompleted ? "bg-green-50" : (task.DueDate < DateTimeOffset.Now ? "bg-red-50" : ""))">
                        <td class="px-6 py-4 whitespace-nowrap font-medium text-gray-900">@task.Title</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">@task.CategoryName</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full
                                        @(task.PriorityName == "Високий" ? "bg-red-100 text-red-800" : task.PriorityName == "Середній" ? "bg-yellow-100 text-yellow-800" : "bg-blue-100 text-blue-800")">
                                @task.PriorityName
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">@task.DueDate.ToLocalTime().ToString("dd.MM.yyyy HH:mm")</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full @(task.IsCompleted ? "bg-green-100 text-green-800" : "bg-yellow-100 text-yellow-800")">
                                @(task.IsCompleted ? "Виконано" : "В роботі")
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                            <a asp-action="TaskDetails" asp-route-id="@task.Id" class="text-blue-600 hover:text-blue-900">Деталі</a>
                            <a asp-action="Edit" asp-route-id="@task.Id" class="text-indigo-600 hover:text-indigo-900">Редагувати</a>
                            <a asp-action="Delete" asp-route-id="@task.Id" class="text-red-600 hover:text-red-900">Видалити</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
else
{
    <div class="bg-blue-100 border-l-4 border-blue-500 text-blue-700 p-4 rounded-lg" role="alert">
        <p class="font-bold">Інформація</p>
        <p>Наразі у вас немає активних завдань. Створіть перше!</p>
    </div>
}